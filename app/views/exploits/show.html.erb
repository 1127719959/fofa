<% content_for :title, @e.name+"/漏洞库信息" %>

<%= stylesheet_link_tag    "highlight", media: "all", "data-turbolinks-track" => true %>
<h1><%=@e.name%></h1>

<div class="bs-component">
  <ul class="breadcrumb">
    <li><%= link_to '首页', '/' %></li>
    <li><%= link_to '漏洞库', exploits_path %></li>
    <li class="active">漏洞库详情</li>
  </ul>
</div>

<div class="row">
  <div class="col-lg-12">
    <h2 id="bookmarklet">描述</h2>
    <p><%=@e.description%></p>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <h2 id="bookmarklet">作者</h2>
    <p><%=JSON.parse(@e.author)[0]%></p>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <h2 id="bookmarklet">参考</h2>
    <%JSON.parse(@e.references).each{|r|%>
      <%if r.kind_of?(String)%>
        <p>
          <%=link_to r,r%>
        </p>
      <%else
          case r[0]
            when 'wooyun'%>
                <p>
                  <%=link_to r[0]+"-"+r[1], "http://www.wooyun.org/bugs/"+r[0]+"-"+r[1], :target => "_blank"%>
                </p>
          <%when 'CVE'%>
                <p>
                  <%=link_to r[0]+"-"+r[1], "http://www.cvedetails.com/cve/"+r[0]+"-"+r[1], :target => "_blank"%>
                </p>
          <%when 'exploit-db'%>
                <p>
                  <%=link_to r[0]+"-"+r[1], "http://www.exploit-db.com/exploits/"+r[0]+"/", :target => "_blank"%>
                </p>
        <%end%>
      <%end%>
    <%}%>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <h2 id="bookmarklet">目标</h2>
    <p><%=link_to @e.product, @e.homepage, :target => "_blank"%></p>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <h2 id="bookmarklet">代码</h2>
    <p><pre><code><%= raw(highlight_code(:ruby, @e.content).gsub!(/(\n)/, "<br />").force_encoding('UTF-8')) %></code></pre></p>

  </div>
</div>